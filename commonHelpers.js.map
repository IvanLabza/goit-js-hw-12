{"version":3,"file":"commonHelpers.js","sources":["../src/js/api.js","../src/js/renderApp.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nconst key = '38303120-77261ecd691aecbe62c4afdac';\nconst baseUrl = 'https://pixabay.com/api/';\n\nexport async function fetchPhotos(query, page, perPage) {\n  const response = await axios.get(\n    `${baseUrl}?key=${key}&q=${query}&image_type=photo&orientation=horizontal&safesearch=false&page=${page}&per_page=${perPage}`\n  );\n  return response.data;\n}\n","export default function createGallery(photos) {\n  const markup = photos\n    .map(photo => {\n      const {\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      } = photo;\n      return `<div class=\"photo-card\">\n            <a class=\"gallery-link\" href=\"${largeImageURL}\">\n  <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n  <div class=\"info\">\n    <p class=\"info-item\">\n      <b>Likes</b>${likes}\n    </p>\n    <p class=\"info-item\">\n      <b>Views</b>${views}\n    </p>\n    <p class=\"info-item\">\n      <b>Comments</b>${comments}\n    </p>\n    <p class=\"info-item\">\n      <b>Downloads</b>${downloads}\n    </p>\n  </div>\n</a></div>`;\n    })\n    .join('');\n\n  return markup;\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { fetchPhotos } from './js/api.js';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport createGallery from './js/renderApp.js';\n\nlet simpleLightBox = new SimpleLightbox('.gallery a');\nlet query = '';\nlet page = 1;\nconst perPage = 40;\n\nconst searchFormEl = document.querySelector('.search-form');\nconst galleryListEl = document.querySelector('.gallery');\nconst loadMoreBtnEl = document.querySelector('.load-more');\nconst inputEl = searchFormEl.firstElementChild;\n\nfunction getGalleryCardHeight() {\n  const galleryCard = document.querySelector('.photo-card');\n  const cardHeight = galleryCard.getBoundingClientRect().height;\n  return cardHeight;\n}\n\nfunction smoothScroll() {\n  const cardHeight = getGalleryCardHeight();\n  const scrollAmount = cardHeight * 2;\n  window.scrollBy({\n    top: scrollAmount,\n    behavior: 'smooth',\n  });\n}\n\nfunction handleSearchFormOnSubmit(event) {\n  event.preventDefault();\n  if (!loadMoreBtnEl.classList.contains('is-hidden')) {\n    loadMoreBtnEl.classList.add('is-hidden');\n    console.log('есть');\n  }\n  query = inputEl.value.trim();\n  page = 1;\n  if (!query) {\n    iziToast.warning({\n      title: 'Warning',\n      message: 'The search string cannot be empty.',\n      position: 'topRight',\n      timeout: 3000,\n    });\n    return;\n  }\n  fetchPhotos(query, page, perPage)\n    .then(data => {\n      console.log(data);\n      if (data.totalHits === 0) {\n        iziToast.error({\n          title: 'Error',\n          message:\n            'Sorry, there are no images matching your search query. Please try again.',\n          position: 'topRight',\n          timeout: 3000,\n        });\n      } else if (data.totalHits !== 0) {\n        galleryListEl.innerHTML = createGallery(data.hits);\n        simpleLightBox.refresh();\n        iziToast.success({\n          title: 'Success',\n          message: `Hooray! We found ${data.totalHits} images.`,\n          position: 'topRight',\n          timeout: 3000,\n        });\n        if (data.totalHits > perPage) {\n          loadMoreBtnEl.classList.remove('is-hidden');\n        }\n\n        const amountOfPages = Math.ceil(data.totalHits / perPage);\n        if (page >= amountOfPages) {\n          iziToast.warning({\n            title: 'Warning',\n            message:\n              \"We're sorry, but you've reached the end of search results.\",\n            position: 'topRight',\n            timeout: 3000,\n          });\n        }\n      }\n    })\n    .catch(onFetchError)\n    .finally(() => {\n      searchFormEl.reset();\n    });\n}\n\nfunction handleMoreBtnClick() {\n  page += 1;\n  fetchPhotos(query, page, perPage)\n    .then(data => {\n      const amountOfPages = Math.ceil(data.totalHits / perPage);\n      if (\n        !loadMoreBtnEl.classList.contains('is-hidden') &&\n        (page >= amountOfPages || data.totalHits <= perPage)\n      ) {\n        loadMoreBtnEl.classList.add('is-hidden');\n        if (page >= amountOfPages) {\n          iziToast.warning({\n            title: 'Warning',\n            message:\n              \"We're sorry, but you've reached the end of search results.\",\n            position: 'topRight',\n            timeout: 3000,\n          });\n        } else {\n          iziToast.warning({\n            title: 'Warning',\n            message: 'Sorry, there are no more photos.',\n            position: 'topRight',\n            timeout: 3000,\n          });\n        }\n      }\n\n      galleryListEl.insertAdjacentHTML('beforeend', createGallery(data.hits));\n      simpleLightBox.refresh();\n      smoothScroll();\n    })\n    .catch(onFetchError);\n}\n\nsearchFormEl.addEventListener('submit', handleSearchFormOnSubmit);\nloadMoreBtnEl.addEventListener('click', handleMoreBtnClick);\n\nfunction onFetchError(error) {\n  iziToast.success('Oops! Something went wrong! Try reloading the page!', {\n    position: 'topRight',\n    timeout: 3000,\n    width: '600px',\n    fontSize: '24px',\n  });\n  console.log(error);\n}\n"],"names":["key","baseUrl","fetchPhotos","query","page","perPage","axios","createGallery","photos","photo","largeImageURL","webformatURL","tags","likes","views","comments","downloads","simpleLightBox","SimpleLightbox","searchFormEl","galleryListEl","loadMoreBtnEl","inputEl","getGalleryCardHeight","smoothScroll","scrollAmount","handleSearchFormOnSubmit","event","iziToast","data","amountOfPages","onFetchError","handleMoreBtnClick","error"],"mappings":"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"}